<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Don Allison]]></title>
  <link href="http://doneallison.github.io/atom.xml" rel="self"/>
  <link href="http://doneallison.github.io/"/>
  <updated>2014-12-24T18:18:51-05:00</updated>
  <id>http://doneallison.github.io/</id>
  <author>
    <name><![CDATA[Don Allison]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Corporate Development Environment, Part II: Customizing the Command Line]]></title>
    <link href="http://doneallison.github.io/blog/2014/12/24/customizing-the-command-line/"/>
    <updated>2014-12-24T18:09:21-05:00</updated>
    <id>http://doneallison.github.io/blog/2014/12/24/customizing-the-command-line</id>
    <content type="html"><![CDATA[<h2>Introduction</h2>

<p>In my <a href="http://doneallison.com/blog/2014/12/23/creating-a-development-environment-on-my-company-issued-laptop/">last post</a>, I used VirtualBox to create a Lubuntu virtual machine (VM) on a Macbook Pro host. I undertook this project because I wanted to create a POSIX-compliant development environment that will work on my company-issued Lenovo T440. Although I&rsquo;ve technically cleared that hurdle at this point, I wanted to customize the VM a bit more so it better resembles the development environment I know and love on my Macbook Pro. Since software developers spend a lot of time using the command line, the next logical step was to customize <a href="http://en.wikipedia.org/wiki/Bash_%28Unix_shell%29">Bash</a> and <a href="http://en.wikipedia.org/wiki/LXDE#Software_components">LXTerminal</a>.<!--more--></p>

<h2>Customizing the Bash Prompt</h2>

<p>Bourne Again Shell (Bash) is a popular command-line interpreter for Unix-like operating systems. It allows users to control computers by typing text commands into a <a href="http://en.wikipedia.org/wiki/Terminal_emulator">terminal emulator</a>. Before the development of <a href="http://en.wikipedia.org/wiki/Graphical_user_interface">graphical user interfaces</a> (GUIs), this was the dominant means of interacting with a computer, and it&rsquo;s still quite common. Learning to use the command line is harder than learning to use a GUI, but the command line is generally faster and more powerful when used correctly. In many cases, for example, a sequence of several clicks on various menus can be reduced to a single command.</p>

<p>By default, the Bash <em>prompt</em> (the sequence of symbols that indicates where the user should type commands) on LXTerminal looks as follows in my VM: <code>don@don-devenv:~$</code>. This prompt may look complicated, but it&rsquo;s actually quite simple. The <code>don@don-devenv</code> simply denotes that user <code>don</code> is logged in on the computer named <code>don-devenv</code>. The <code>:~</code> indicates that the user is in the root directory (<code>home/don</code>) of don-devenv (<code>~</code> is an alias for <code>home/don</code>). The <code>$</code> indicates the end of the prompt, where the user should type commands.</p>

<p>I modified this prompt to provide a bit more functionality. First, I added a timestamp to the prompt, which will allow me to tell when I issued certain commands. Second, I added some code that displays the active <a href="http://en.wikipedia.org/wiki/Git_%28software%29">Git</a> branch when I change directories into a Git repository. This relieves me of having to type <code>git branch</code> to retrieve that information. Finally, I changed the <code>$</code> to a red <code>♥</code>, although I could have chosen a different Unicode character.</p>

<p>Thanks to the good folks at <a href="http://flatironschool.com/">The Flatiron School</a> (of which I am now a proud alum), implementing these changes was pretty simple. First, I forked their <a href="https://github.com/flatiron-school/dotfiles">dotfiles</a> repository and made a few small changes to the <code>.bash_profile</code> file (my changes are available <a href="https://github.com/doneallison/dotfiles/blob/master/bash_profile">here</a>). Then, I copied the entire, modified <code>.bash_profile</code> file into the root directory on the VM. Finally, I added a short statement to the bottom of the <code>.bashrc</code> file on the VM to ensure that Bash loads the custom shell whenever I open LXTerminal. Step-by-step instructions are below.</p>

<p>
<div class="ratio-4-3 embed-video-container" onclick="var myAnchor = document.getElementById('gGDdl5eDR28');var tmpDiv = document.createElement('div');tmpDiv.innerHTML = '&lt;iframe style=&quot;vertical-align:top;width:100%;height:100%;position:absolute;&quot; src=&quot;http://www.youtube.com/embed/gGDdl5eDR28?autoplay=1&quot; frameborder=&quot;0&quot; allowfullscreen&gt;&lt;/iframe&gt;';myAnchor.parentNode.replaceChild(tmpDiv.firstChild, myAnchor);return false;" title="click here to play">
<a class="youtube-lazy-link" style="width:100%;height:100%;background:#000 url(http://i2.ytimg.com/vi/gGDdl5eDR28/0.jpg) center center no-repeat;background-size:contain;position:absolute" href="http://www.youtube.com/watch?v=gGDdl5eDR28" id="gGDdl5eDR28" onclick="return false;">
<div class="youtube-lazy-link-div"></div>
<div class="youtube-lazy-link-info">Creating a Custom Bash Profile in LXTerminal</div>
</a>
<div class="video-info" >This video was created to complement a blog post at http://doneallison.com.</div>
</div>

</p>


<ol>
<li>In the VM, open LXTerminal and navigate to the root directory (type <code>cd ~</code>)</li>
<li>Type <code>touch .bash_profile</code> to create a file for the settings, and then <code>leafpad .bash_profile</code> to open it in a text editor</li>
<li>Copy the <a href="https://github.com/doneallison/dotfiles/blob/master/bash_profile">bash profile</a> on my GitHub and paste it into Leafpad</li>
<li>Save and close</li>
<li>Type <code>source .bash_profile</code> to reload the bash profile</li>
<li>Type <code>leafpad .bashrc</code> to open the <code>.bashrc</code> file</li>
<li>Type the following text at the bottom of the file: <code>. ~/.bash_profile</code></li>
<li>Save and close</li>
<li>Exit the terminal and then restart it. The changes should be apparent</li>
</ol>


<h2>Customizing the Look and Feel of LXTerminal</h2>

<p>In addition to adding custom styling to my command prompt, I also like to customize the fonts and colors. In LXTerminal, I was able to do this by editing the <code>lxterminal.conf</code> file. First, I typed <code>leafpad ~/.config/lxterminal/lxterminal.conf</code> in the command prompt to open the file. Then, I added the following settings:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[general]
</span><span class='line'>fontname=DejaVu Sans Mono 14
</span><span class='line'>selchars=-A-Za-z0-9,./?%&#:_
</span><span class='line'>scrollback=1000
</span><span class='line'>bgcolor=#00002b2b3636
</span><span class='line'>bgalpha=65535
</span><span class='line'>fgcolor=#65657b7b8383
</span><span class='line'>disallowbold=false
</span><span class='line'>cursorblinks=false
</span><span class='line'>cursorunderline=false
</span><span class='line'>audiblebell=false
</span><span class='line'>tabpos=top
</span><span class='line'>hidescrollbar=false
</span><span class='line'>hidemenubar=false
</span><span class='line'>hideclosebutton=false
</span><span class='line'>disablef10=false
</span><span class='line'>disablealt=false</span></code></pre></td></tr></table></div></figure>


<p>These settings result in a larger font and a <a href="http://en.wikipedia.org/wiki/Solarisation">&ldquo;solarized&rdquo;</a> color scheme (specific colors courtesy of GitHub user <a href="https://gist.github.com/perusio/1154002">perusio</a>).</p>

<p><img class="center" src="http://doneallison.github.io/images/customizing-lxterminal/customized_terminal.png"></p>

<h2>Coming Up&hellip;</h2>

<p>When they&rsquo;re not in the command line, software developers can often be found in the text editor. Accordingly, in my next post, I&rsquo;ll turn my attention to installing and customizing <a href="http://www.sublimetext.com/">Sublime Text</a>, my text editor of choice.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Creating a Development Environment on My Company-Issued Laptop]]></title>
    <link href="http://doneallison.github.io/blog/2014/12/23/creating-a-development-environment-on-my-company-issued-laptop/"/>
    <updated>2014-12-23T22:21:47-05:00</updated>
    <id>http://doneallison.github.io/blog/2014/12/23/creating-a-development-environment-on-my-company-issued-laptop</id>
    <content type="html"><![CDATA[<h2>Background and Motivation</h2>

<p>Since The Flatiron School Science Fair a couple weeks ago, my attention - like that of most of my classmates - has turned to finding a job. After shelling out for tuition and going three months without income, we&rsquo;re all eager to begin earning money again. For a variety of reasons, I&rsquo;ve decided to return to the position I held before coming to The Flatiron School. Although I&rsquo;m really excited about this move, it does come with an unfortunate downside: having to reacclimate to my company-issued Lenovo T440 after having spent a glorious three months with my beloved Macbook Pro.<!--more--></p>

<p>Don&rsquo;t get me wrong; it could be worse. Apart from its horrendous touchpad, the T440 isn&rsquo;t a bad computer. It even has a pretty good display, especially if you haven&rsquo;t yet been spoiled by a Retina Display. For a software developer, however, the T440 has a major flaw: it runs Windows 7. This is a problem not because Windows 7 is bad, but because Windows 7, like all other versions of Windows, is incompatible with <a href="http://en.wikipedia.org/wiki/POSIX">POSIX</a>.</p>

<p>First released in 1988, POSIX (Portable Operating System Interface) is a set of standards for designing operating systems. It reduces compatibility issues between compliant operating systems by defining common <a href="http://en.wikipedia.org/wiki/Application_programming_interface">APIs</a> and system utilities. POSIX is supported to some degree by most Unix-like operating systems, including Mac OS X (fully POSIX compliant) and GNU/Linux (mostly POSIX compliant).</p>

<p>Since many software developers use Unix-like systems to write or deploy code, having a POSIX-compliant system makes it easier to share code with other developers. Moreover, I&rsquo;ve spent the last three months developing habits in a POSIX-compliant environment. Switching now would mean accepting a steep new learning curve to learn tools and patterns with limited relevance outside the (decreasingly important) Windows universe. Accordingly, I decided to research ways of bringing POSIX to the workplace.</p>

<h2>Making Windows POSIX-Compliant</h2>

<p>Since my bosses are unlikely to spring for a Macbook Pro, and since I can&rsquo;t simply wipe Windows 7 and install a fresh copy of Ubuntu, I had to find some way of creating a POSIX-compliant environment within Windows 7. After a bit of research, two popular alternatives emerged: Cygwin and virtualization.</p>

<h3>Cygwin</h3>

<p><a href="http://en.wikipedia.org/wiki/Cygwin">Cygwin</a> is a Windows program that provides a Unix-like command line and some degree of POSIX compliance. Although I don&rsquo;t fully understand Cygwin and could certainly be selling it short, it seems most valuable in providing a Unix-like alternative to Windows&#8217; stock Command Prompt. If you want to do something more complex, like use RVM to manage multiple versions of Ruby, my sense is that you begin to reach Cygwin&rsquo;s limits. In addition, Cygwin would likely involve somewhat of a learning curve. For these reasons, I decided to leave Cygwin as an alterantive to explore if virtualization, my preferred option, didn&rsquo;t work.</p>

<h3>Virtualization</h3>

<p>In the context of this post, <a href="http://en.wikipedia.org/wiki/Virtualization">virtualization</a> refers to the process of running a virtual instance of one computer atop the resources of a second, actual computer. Virtualization seemed like a compelling solution to the problem of bringing POSIX to Windows because it promised the ability to run mostly POSIX-compliant GNU/Linux atop Windows 7. In other words, I&rsquo;d be able to run GNU/Linux on my work computer without wiping or partitioning the hard drive.</p>

<p>Virtualization, of course, is not magic. It comes with a performance penalty. Since the <em>host</em> operating system (in my case, Windows 7) has to share physical resources like RAM with the <em>guest</em> operating system (in my case, GNU/Linux), both systems take a performance hit. Thankfully, though, the type of software development I plan on doing is not especially resource-intensive. Accordingly, I decided to build a virtual GNU/Linux machine to run atop my company-issued laptop.</p>

<p>Since I&rsquo;m traveling for the holidays and don&rsquo;t have access to the T440, I decided to create the virtual machine (VM) on my Macbook Pro and then transfer it later to the T440. My ability to do this highlights one of the beautiful aspects of virtualization: that the guest OS is agnostic about its host as long as the host has compatible virtualization software and sufficient physical resources. When it comes time to move the VM, all I&rsquo;ll have to do is copy over a single image file.</p>

<h2>Choosing and Obtaining Software</h2>

<p>For the actual virtualization software, I went with <a href="https://www.virtualbox.org/">VirtualBox</a>. It&rsquo;s not quite as polished as something like VMWare, but it&rsquo;s powerful, cross-platform, and free. For the GNU/Linux distribution, I went with <a href="http://lubuntu.net/">Lubuntu</a>, which is based on <a href="http://www.ubuntu.com/desktop">Ubuntu</a> but uses the light-weight <a href="http://lxde.org/">LXDE</a> desktop environment. Lubuntu is a good fit because it was designed with resource-constrained systems in mind but is largely compatible with Ubuntu, which has a large, active, and helpful community. Since I decided I could only devote 1GB of RAM to the VM, I grabbed the 32-bit version of Lubuntu from the <a href="https://help.ubuntu.com/community/Lubuntu/GetLubuntu#Standard_PC">official downloads page</a>.</p>

<h2>Creating the Virtual Machine</h2>

<p>Having installed VirtualBox and downloaded the ~740MB Lubuntu .iso, I was ready to get started. The first step was to create the VM in VirtualBox. During this process, I accepted most of the defaults apart from selecting the correct OS (32-bit Ubuntu Linux), entering a unique name (&ldquo;devenv&rdquo;), and changing the default memory allocation from 512MB to 1024MB.</p>

<p>
<div class="ratio-4-3 embed-video-container" onclick="var myAnchor = document.getElementById('xh35wRElX6U');var tmpDiv = document.createElement('div');tmpDiv.innerHTML = '&lt;iframe style=&quot;vertical-align:top;width:100%;height:100%;position:absolute;&quot; src=&quot;http://www.youtube.com/embed/xh35wRElX6U?autoplay=1&quot; frameborder=&quot;0&quot; allowfullscreen&gt;&lt;/iframe&gt;';myAnchor.parentNode.replaceChild(tmpDiv.firstChild, myAnchor);return false;" title="click here to play">
<a class="youtube-lazy-link" style="width:100%;height:100%;background:#000 url(http://i2.ytimg.com/vi/xh35wRElX6U/0.jpg) center center no-repeat;background-size:contain;position:absolute" href="http://www.youtube.com/watch?v=xh35wRElX6U" id="xh35wRElX6U" onclick="return false;">
<div class="youtube-lazy-link-div"></div>
<div class="youtube-lazy-link-info">Creating a Virtual Machine with VirtualBox</div>
</a>
<div class="video-info" >This video was created to complement a blog post at http://doneallison.com.</div>
</div>

</p>


<p>The next step was to boot the VM by clicking on it in the VirtualBox sidebar. Since I hadn&rsquo;t installed an operating system yet, VirtualBox prompted me to select the media or image to boot from. I selected the Lubuntu .iso, and VirtualBox began running it in a separate window. From that point on, I followed a standard installation process in the VM. (Please note: The video below has been edited for length. The actual installation process took about 11 minutes on my computer.)</p>

<p>
<div class="ratio-4-3 embed-video-container" onclick="var myAnchor = document.getElementById('724Ey73Q2n8');var tmpDiv = document.createElement('div');tmpDiv.innerHTML = '&lt;iframe style=&quot;vertical-align:top;width:100%;height:100%;position:absolute;&quot; src=&quot;http://www.youtube.com/embed/724Ey73Q2n8?autoplay=1&quot; frameborder=&quot;0&quot; allowfullscreen&gt;&lt;/iframe&gt;';myAnchor.parentNode.replaceChild(tmpDiv.firstChild, myAnchor);return false;" title="click here to play">
<a class="youtube-lazy-link" style="width:100%;height:100%;background:#000 url(http://i2.ytimg.com/vi/724Ey73Q2n8/0.jpg) center center no-repeat;background-size:contain;position:absolute" href="http://www.youtube.com/watch?v=724Ey73Q2n8" id="724Ey73Q2n8" onclick="return false;">
<div class="youtube-lazy-link-div"></div>
<div class="youtube-lazy-link-info">Installing Lubuntu within a VirtualBox Virtual Machine</div>
</a>
<div class="video-info" >This video was created to complement a blog post at http://doneallison.com.

Please note: This video has been edited to reduce its overall length. The actual installation process took about 11 minutes.</div>
</div>

</p>


<p>After completing the installation process, I rebooted the VM to arrive at my fresh Lubuntu desktop.</p>

<p><img class="center" src="http://doneallison.github.io/images/corporate-environment/lubuntu_desktop.png"></p>

<h2>Incorporating Guest Additions</h2>

<p>After booting the VM, the first thing I noticed was how low the resolution was - only 640x480. In an effort to fix this, I clicked <code>Start &gt; Preferences &gt; Monitor Settings</code>. This brought up the menu I was looking for, but the only other option was &ldquo;Auto.&rdquo; This setting didn&rsquo;t change anything, so I started Googling around. It turns out that I needed to install a VirtualBox package called &ldquo;Guest Additions&rdquo; on the VM. Although the image needed to install Guest Additions comes bundled with VirtualBox, it&rsquo;s not the easiest thing to find and install. After some experimentation, I got it to work with the process described below. Please note that steps 1-4 may vary on non-Mac systems; however, it basically just involves copying a file to a convenient directory and then later selecting that file.</p>

<p>
<div class="ratio-4-3 embed-video-container" onclick="var myAnchor = document.getElementById('Y2TcQK49pbA');var tmpDiv = document.createElement('div');tmpDiv.innerHTML = '&lt;iframe style=&quot;vertical-align:top;width:100%;height:100%;position:absolute;&quot; src=&quot;http://www.youtube.com/embed/Y2TcQK49pbA?autoplay=1&quot; frameborder=&quot;0&quot; allowfullscreen&gt;&lt;/iframe&gt;';myAnchor.parentNode.replaceChild(tmpDiv.firstChild, myAnchor);return false;" title="click here to play">
<a class="youtube-lazy-link" style="width:100%;height:100%;background:#000 url(http://i2.ytimg.com/vi/Y2TcQK49pbA/0.jpg) center center no-repeat;background-size:contain;position:absolute" href="http://www.youtube.com/watch?v=Y2TcQK49pbA" id="Y2TcQK49pbA" onclick="return false;">
<div class="youtube-lazy-link-div"></div>
<div class="youtube-lazy-link-info">Installing Guest Additions in VirtualBox with Mac Host and Lubuntu Guest</div>
</a>
<div class="video-info" >This video was created to complement a blog post at http://doneallison.com.</div>
</div>

</p>


<ol>
<li>Copy <code>VBoxGuestAdditions.iso</code> image from the VirtualBox directory to the root directory. You can do this through Finder, but the following terminal command also works: <code>sudo cp /Applications/VirtualBox.app/Contents/MacOS/VBoxGuestAdditions.iso ~/</code></li>
<li>Start the VM and log in</li>
<li>On the VirtualBox menu, go to <code>Devices &gt; CD/DVD Devices &gt; Choose a virtual CD/DVD disk file...</code></li>
<li>Navigate to the root directory and select the <code>VBoxGuestAdditions.iso</code> file you copied there in step 1</li>
<li>In the VM, close the autorun prompt that appears after a few moments and press <code>Ctrl + Alt + T</code> to open LXTerminal</li>
<li>Type <code>cd ../../media/USER</code>, where <code>USER</code> is your username (mine is &ldquo;don&rdquo;), to change into the VBoxGuestAdditions.iso directory</li>
<li>Type <code>ls</code> to show the contents of that directory. There should only be one subdirectory, called something like <code>VBOXADDITIONS_4.3.20_96996</code> (the precise name changes with each version of VirtualBox). Type <code>cd</code> followed by a space and then the name of that directory to change into it. In practice, you can probably just type <code>cd V</code>, and then press tab to auto-complete the filename, and then press enter</li>
<li>Type <code>sudo apt-get update</code> to grab any updates to packages installed on your system</li>
<li>Type <code>sudo apt-get upgrade</code> to install those updates</li>
<li>Type <code>sudo apt-get install dkms</code> to install <a href="http://en.wikipedia.org/wiki/Dynamic_Kernel_Module_Support">dkms</a></li>
<li>Type <code>sudo sh VBoxLinuxAdditions.run</code> to install Guest Additions</li>
<li>Restart the VM</li>
</ol>


<p>After following these steps, I restarted the VM and was able to put it in full-screen mode by pressing <code>Right ⌘ + F</code> (the default is <code>Left ⌘ + F</code>, but I changed it to right). Since Lubuntu puts the menu bar at the bottom of the screen, I removed the auto-hiding menu bar that VirtualBox puts on the bottom of the screen by default. I did this by right-clicking the VM in the VirtualBox sidebar, selecting <code>Advanced</code> on the <code>General</code> menu, and deselecting <code>Show in Fullscreen/Seamless</code>.</p>

<p>The steps outlined in this post left me with a basic VM that I will be able to run on my company-issued T440. But the VM still doesn&rsquo;t feel like <em>home</em>. In my next few posts, I&rsquo;ll cover a few of the other customizations I made to complete my corporate development environment.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Debugging JavaScript]]></title>
    <link href="http://doneallison.github.io/blog/2014/11/17/debugging-javascript/"/>
    <updated>2014-11-17T23:29:52-05:00</updated>
    <id>http://doneallison.github.io/blog/2014/11/17/debugging-javascript</id>
    <content type="html"><![CDATA[<h2>The Problem</h2>

<p>Ever since my class at <a href="http://flatironschool.com/">The Flatiron School</a> took a detour into JavaScript from Ruby and Rails, I&rsquo;ve found it harder to debug my code. I think this has happened for a couple of reasons. First, JavaScript has a fussier syntax than Ruby, and, as a beginner, I don&rsquo;t always know where to put my semicolons, curly braces, <code>var</code> keywords, etc. Second, JavaScript is highly permissive, and, as a result, its error messages tend to be less helpful than those of Ruby.<!--more--> Take, for example, the following Ruby code:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">def</span> <span class="nf">my_method</span><span class="p">(</span><span class="n">arg1</span><span class="p">,</span> <span class="n">arg2</span><span class="p">)</span>
</span><span class='line'>  <span class="n">arg1</span> <span class="o">+</span> <span class="n">arg2</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="n">my_method</span><span class="p">(</span><span class="s2">&quot;Hello world!&quot;</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>If I type this into irb, I get the following error message:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="ss">ArgumentError</span><span class="p">:</span> <span class="n">wrong</span> <span class="n">number</span> <span class="n">of</span> <span class="n">arguments</span> <span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="mi">2</span><span class="p">)</span>
</span><span class='line'>  <span class="n">from</span> <span class="p">(</span><span class="n">irb</span><span class="p">):</span><span class="mi">1</span><span class="ss">:in</span> <span class="sb">`my_method&#39;</span>
</span><span class='line'><span class="sb"> from (irb):5</span>
</span><span class='line'><span class="sb"> from /Users/don/.rvm/rubies/ruby-2.1.2/bin/irb:11:in `</span><span class="o">&lt;</span><span class="n">main</span><span class="o">&gt;</span><span class="err">&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<p>This is a helpful error message. It tells me that I supplied the wrong number of arguments when I called <code>my_method</code> in line 5. Specifically, I supplied one argument where <code>my_method</code> requires two.</p>

<p>Contrast this with the equivalent in JavaScript:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='JavaScript'><span class='line'><span class="kd">function</span> <span class="nx">myFunc</span><span class="p">(</span><span class="nx">arg1</span><span class="p">,</span> <span class="nx">arg2</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">return</span> <span class="nx">arg1</span> <span class="o">+</span> <span class="nx">arg2</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="nx">myFunc</span><span class="p">(</span><span class="s2">&quot;Hello world!&quot;</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>When I run this code, I don&rsquo;t get an error message. Instead, I get:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='JavaScript'><span class='line'><span class="s2">&quot;hello worldundefined&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Huh?</p>

<p>As I wrote above, JavaScript is very permissive. If there&rsquo;s any way JavaScript can make do with what the programmer provides, JavaScript tries to do it. In this case, it simply inserted the default value <code>undefined</code> in place of the argument I failed to supply.</p>

<p>This aspect of JavaScript gives it the potential to be highly expressive, but it also complicates things for JavaScript novices. Once JavaScript programs become even mildly complex, small errors like the one above can easily break programs, and JavaScript does not offer much help in diagnosing the problem. At best, it supplies a cryptic error message like <code>'undefined' is not a function</code>; at worst, it cheerfully returns <code>undefined</code>, as though everything went according to plan.</p>

<p>Given these (seeming) issues, I decided to research tools that could help me debug my JavaScript code.</p>

<h2>Solutions</h2>

<h3>Syntax</h3>

<p>As I mentioned above, I think JavaScript&rsquo;s fussy syntax is one of the things that makes it difficult to debug. Especially for beginners, it&rsquo;s easy to break programs by mistakenly omitting a semicolon or committing some other seemingly minor transgression. Fortunately, this problem turns out to have an easy fix: <a href="http://jshint.com/">JSHint</a>. JSHint is a multi-platform tool that identifies syntax errors and other code quality issues in JavaScript code. Their web interface works quite well for casual experimentation, but their Sublime Text plugin (also available for <a href="http://www.jshint.com/install/">other platforms</a>) is more practical for day-to-day use. Here&rsquo;s how I installed it (for Sublime Text 3):</p>

<ol>
<li><strong><a href="https://sublime.wbond.net/installation">Install Package Control</a></strong>, which makes it easy to add and remove Sublime Text packages.

<ul>
<li>Copy the appropriate block of Python code from the <a href="https://sublime.wbond.net/installation">Package Control installation page</a></li>
<li>Switch from your web browser to Sublime Text</li>
<li>Press <code>ctrl + `</code> to bring up the Sublime Text console</li>
<li>Paste the Python code into the console and press enter</li>
<li>Restart Sublime Text</li>
</ul>
</li>
<li><strong><a href="http://sublimelinter.readthedocs.org/en/latest/installation.html">Install SublimeLinter</a></strong>, a framework for language-specific packages that <a href="http://en.wikipedia.org/wiki/Lint_(software">lint</a> code within Sublime Text.

<ul>
<li>In Sublime Text, press <code>command + shift + p</code> to bring up the command palette</li>
<li>Begin typing &ldquo;Package Control: Install Package&rdquo;, and select that option once it&rsquo;s visible</li>
<li>Begin typing &ldquo;SublimeLinter&rdquo;, and select that option once it&rsquo;s visible</li>
<li>Restart Sublime Text</li>
</ul>
</li>
<li><strong><a href="http://nodejs.org/">Install Node.js</a></strong>, a run-time environment for JavaScript. The easiest way is to click &ldquo;Install&rdquo; button on the homepage and then follow the installer&rsquo;s instructions.</li>
<li><strong><a href="http://jshint.com/">Install JSHint</a></strong> for Node.js using npm (Node Package Manager).

<ul>
<li>Open Terminal and type <code>npm install -g jshint</code> (the -g flag makes JSHint available &ldquo;globally&rdquo; - i.e., in all directories on your computer)</li>
<li>If this fails (as it did on my computer), issue the same command with elevated permissions: <code>sudo npm install -g jshint</code></li>
</ul>
</li>
<li><strong><a href="https://github.com/SublimeLinter/SublimeLinter-jshint">Install SublimeLinter-jshint</a></strong>, which allows SublimeLinter to work with JavaScript code.

<ul>
<li>In Sublime Text, press <code>command + shift + p</code> to bring up the command palette</li>
<li>Begin typing &ldquo;Package Control: Install Package&rdquo;, and select that option once it&rsquo;s visible</li>
<li>Begin typing &ldquo;SublimeLinter-jshint&rdquo;, and select that option once it&rsquo;s visible</li>
<li>Restart Sublime Text</li>
</ul>
</li>
</ol>


<p>After completing these steps, SublimeLinter-jshint should automatically point out JavaScript syntax errors in Sublime Text.</p>

<h3>Debugging</h3>

<p>Having eliminated one class of errors (syntax errors), I turned my attention to finding JavaScript equivalents of <a href="http://en.wikipedia.org/wiki/Interactive_Ruby_Shell">irb</a>, a command-line tool that makes it easy to test fragments of Ruby code, and <a href="https://github.com/pry/pry/wiki">pry</a>, a tool that allows programmers to step through Ruby code at specified breakpoints in a program.</p>

<h4>Replacing irb</h4>

<p>irb is the easier of the two tools to replace. Most Mac users probably already have two tools installed that provide similar functionality.</p>

<h5>jsc</h5>

<p>The first is <strong><a href="https://trac.webkit.org/wiki/JSC">jsc</a></strong>, which provides an irb-like interface in the terminal. It actually comes pre-installed on OS X, although it&rsquo;s not in your path by default. To add it to your path, simply open Terminal and run the following command from any directory:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='JavaScript'><span class='line'><span class="nx">sudo</span> <span class="nx">ln</span> <span class="o">-</span><span class="nx">s</span> <span class="o">/</span><span class="nx">System</span><span class="o">/</span><span class="nx">Library</span><span class="o">/</span><span class="nx">Frameworks</span><span class="o">/</span><span class="nx">JavaScriptCore</span><span class="p">.</span><span class="nx">framework</span><span class="o">/</span><span class="nx">Versions</span><span class="o">/</span><span class="nx">Current</span><span class="o">/</span><span class="nx">Resources</span><span class="o">/</span><span class="nx">jsc</span> <span class="o">/</span><span class="nx">bin</span><span class="o">/</span><span class="nx">jsc</span>
</span></code></pre></td></tr></table></div></figure>


<p>Then, you can launch jsc by typing <code>jsc</code> in Terminal. jsc is good for investigating small JavaScript quirks (e.g., what does <code>typeof(null)</code> return?), but in my experience it doesn&rsquo;t accept multi-line blocks with the same ease as irb. As a result, you can&rsquo;t simply copy your code from a text editor and run it in jsc. This makes it a non-ideal replacement for irb.</p>

<h5>Chrome DevTools</h5>

<p>Fortunately, many Mac users already have another JavaScript tool installed that handles multi-line pasting with ease: <a href="https://developer.chrome.com/devtools">Chrome DevTools</a>, &ldquo;a set of web authoring and debugging tools built into Google Chrome.&rdquo; DevTools can be launched by pressing <code>command + option + j</code> from within Google Chrome.</p>

<p><img class="center" src="http://doneallison.github.io/images/debugging-javascript/chromedevtools.png"></p>

<p>Chrome DevTools are amazing, and I&rsquo;m confident I&rsquo;ll find myself using them more as I gain experience. As a novice, however, they feel mildly like overkill in situations when I simply want to test a single function or chunk of code. In addition, using DevTools for small tests requires me to copy code from my text editor and paste it into DevTools (or else edit my code directly in DevTools, missing out on JSHint, syntax highlighting, and other Sublime Text goodness). This takes time and can introduce additional errors (e.g., forgetting to copy a variable declaration that is relied upon in the code I do copy). For these reasons, I decided to look for something simpler.</p>

<h5>Creating a JavaScript Console in Sublime Text</h5>

<p>I ended up finding the answer on <a href="http://www.wikihow.com/Create-a-Javascript-Console-in-Sublime-Text">wikihow.com</a>, of all places. In the article, user Anson S describes a process for writing a Sublime Text plugin that uses Node.js (which we installed earlier) to build and run JavaScript code directly in Sublime Text. Assuming you already have Node.js installed, the process is actually pretty simple:</p>

<ol>
<li><p>Go to <code>Tools &gt; Build System &gt; New Build System...</code> in Sublime Text 3 (this may or may not work in Sublime Text 2).</p></li>
<li><p>In the new tab opened by Sublime Text, paste the following code:
     <code>
     {
     "cmd": ["node", "$file"],
     "selector": "source.js"
     }
    </code></p></li>
<li><p>Press <code>ctrl + s</code> and save the file as <code>node.sublime-build</code> in the folder that Sublime Text brings up by default.</p></li>
</ol>


<p>Then, when you have a JavaScript file open in Sublime Text and want to run it, you can just press <code>command + b</code>. (If this doesn&rsquo;t work, make sure the sublime-build you just created is selected by going to <code>Tools &gt; Build System</code> and selecting <code>node</code>). Sublime Text will build the code using Node.js and then display the result in a small window at the bottom of the editor.</p>

<p><img class="center" src="http://doneallison.github.io/images/debugging-javascript/js_console_in_sublime_text.png"></p>

<h4>Replacing pry</h4>

<p>As far as I&rsquo;ve been able to tell, replacing pry is a bit more difficult than replacing irb. The best tool I&rsquo;ve come across is in - surprise! - DevTools, specifically under the <code>Sources</code> tab. If you open DevTools on a page with the script you want to inspect, you can use the <code>Sources</code> tab to step through and debug the code. As in pry, this allows you to pause execution at specified breakpoints in a program and investigate the environment, including, e.g., the current values of all variables in scope. The main drawback of this function of DevTools is that it&rsquo;s somewhat annoying to get a one-off script (i.e., a script not yet integrated into a minimally functioning webpage) loaded into the tool. As far as I can tell, you can&rsquo;t just open a local file and use the tool on it.</p>

<p>There is a kind of hacky way to sidestep this issue: simply save your JavaScript program as an HTML file, and then enclose all of the JavaScript code between <code>&lt;script&gt;</code> tags:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='JavaScript'><span class='line'><span class="o">&lt;</span><span class="nx">script</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="kd">function</span> <span class="nx">myFunc</span><span class="p">(){</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">test1</span> <span class="o">=</span> <span class="s2">&quot;Hello world!&quot;</span><span class="p">;</span>
</span><span class='line'>  <span class="kr">debugger</span><span class="p">;</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">test2</span> <span class="o">=</span> <span class="s2">&quot;Goodbye world!&quot;</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="nx">myFunc</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="err">/script&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Then, you can open the file in Chrome, press <code>command + option + j</code> to open DevTools, click on the <code>Sources</code> tab, and press <code>command + r</code> to refresh and inspect your code.</p>

<p><img class="center" src="http://doneallison.github.io/images/debugging-javascript/devtools_sources.png"></p>

<p>In this example, we can see that the <code>debugger</code> statement acts as a breakpoint - code execution is paused, and we can examine the current state of each variable under the &ldquo;Scope Variables&rdquo; window. Right now, <code>test1</code> has a value of &ldquo;Hello world!&rdquo;, but <code>test2</code> is still <code>undefined</code> because the <code>debugger</code> statement paused code execution. If we click twice the button to step into the next function call&hellip;</p>

<p><img class="center" src="http://doneallison.github.io/images/debugging-javascript/devtools_sources_button.png"></p>

<p>&hellip;we&rsquo;ll see that <code>test2</code> is now assigned the value of <code>"Goodbye world!"</code>.</p>

<p><img class="center" src="http://doneallison.github.io/images/debugging-javascript/devtools_sources_2.png"></p>

<p>If you don&rsquo;t like inserting <code>debugger</code> statements into your code, you can also create a breakpoint by clicking the left margin of the center pane in the DevTools debugger, which will create a blue arrow indicating a breakpoint at the line selected.</p>

<p>Eventually, I&rsquo;d like to encapsulate this process into a Sublime Text plugin that, when prompted with an appropriate keyboard shortcut, automatically wraps a <code>*.js</code> file being edited in HTML and launches it in a browser for debugging. For now, though, the manual strategy should save me some frustration!</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[My First Web App: Topicana]]></title>
    <link href="http://doneallison.github.io/blog/2014/11/03/my-first-web-app-topicana/"/>
    <updated>2014-11-03T23:57:35-05:00</updated>
    <id>http://doneallison.github.io/blog/2014/11/03/my-first-web-app-topicana</id>
    <content type="html"><![CDATA[<h2>Introduction</h2>

<p>After writing my <a href="http://doneallison.com/blog/2014/10/20/topic-modeling-my-text-messages/">last post</a>, I wanted to explore topic modeling and the <a href="http://mallet.cs.umass.edu/">MAchine Learning for LanguagE Toolkit (MALLET)</a> a bit further. Specifically, I wanted to explore the possibility of liberating MALLET from several usability issues.<!--more--> Here are a few of the issues I had in mind:</p>

<ul>
<li><p><strong>Preparing Data</strong>: It takes a long time to convert source documents into a format that MALLET can understand and analyze, and the transformations are amenable to automation.</p></li>
<li><p><strong>Environment Setup</strong>: Setting up MALLET to work properly can be a fussy process, especially for Windows users.</p></li>
<li><p><strong>Clunky CLI</strong>: Although MALLET does have an independently developed <a href="https://code.google.com/p/topic-modeling-tool/">GUI</a>, most people interact with MALLET through its somewhat clunky CLI. For certain advanced features, the CLI is the only way to interact with MALLET.</p></li>
<li><p><strong>Files, files, and more files</strong>: The only output MALLET provides are large text files that are difficult to evaluate quickly and intuitively. As a result, many users end up importing MALLET output files into Excel <em>every time</em> they train a topic model in order to evaluate the suitability of the model. This long feedback cycle aligns poorly with the iterative, intuitive process required to identify a good topic model.</p></li>
</ul>


<p>Since I had been learning Sinatra at <a href="http://flatironschool.com/">The Flatiron School</a>, I decided to try coding a simple, incomplete solution to these problems. Being a sucker for puns, I called that solution <a href="https://topicana.herokuapp.com/">Topicana</a>.</p>

<h2>A Brief Introduction to Topicana</h2>

<p>Topicana is a simple web form that allows users to extract topics from collections of documents. Users can either provide their own documents (in the form of plaintext or URLs) or ask Topicana to retrieve documents based on keywords. Topicana also allows users to choose whether to enable <a href="http://en.wikipedia.org/wiki/Hyperparameter_optimization">hyperparameter optimization</a> and <a href="http://en.wikipedia.org/wiki/Stop_words">stopword removal</a>.</p>

<p>When a user submits a query, Topicana processes the documents provided into MALLET&rsquo;s internal format and then navigates the MALLET CLI to train a topic model based on those documents and other parameters provided by the user. Once MALLET finishes training the topic model, Topicana converts its raw output into simple tables. One table shows the top keywords in each topic identified, while multiple tables show the topic composition of each article provided to Topicana.</p>

<p>Although Topicana is based on and ultimately reducible to MALLET, it relies on several technologies to automate the tasks of retrieving, parsing, and preparing inputs and formatting and displaying outputs:</p>

<ul>
<li><p><strong>Nokogiri</strong>: Nokogiri parses content retrieved from URLs entered by users.</p></li>
<li><p><strong><a href="https://webhose.io/">webhose.io</a></strong>: At the moment, Topicana uses webhose.io to retrieve content relevant to keywords provided by users. In the future, I&rsquo;ll consider other services such as the <a href="https://developers.google.com/custom-search/json-api/v1/overview">Google Custom Search API</a>, the <a href="https://datamarket.azure.com/dataset/8818F55E-2FE5-4CE3-A617-0B8BA8419F65">Bing Web Search API</a>, and the <a href="http://www.faroo.com/hp/api/api.html">Faroo Free Search API</a> (1,000,000 free transactions each month!), which require a bit more configuration.</p></li>
<li><p><strong>Sinatra</strong>: Sinatra is a lightweight alternative to heavier frameworks like Rails.</p></li>
<li><p><strong>Heroku</strong>: Heroku is a service that allows push-button deployment of web apps directly from Git. After a small amount of setup, you can deploy to Heroku by typing <code>git push heroku master</code> from the command line. Amazing!</p></li>
</ul>


<h2>Next Steps</h2>

<p>Although Topicana is very basic and still unstable, I was excited to get a proof of concept working. I think algorithms based on topic modeling have the potential to help researchers and others navigate, organize, and consume information more efficiently. In the future, I can imagine extending Topicana in a number of ways:</p>

<ul>
<li><p><strong>Improve Stability and Scalability</strong>: Right now, Topicana is kind of shaky on Heroku - sometimes it works, sometimes it doesn&rsquo;t. I suspect at least part of the problem is that I haven&rsquo;t yet implemented background processes, which means that all the text processing takes place within a single request/response cycle. That&rsquo;s frankly pretty nutty and would be one of the first things I&rsquo;d want to fix. I&rsquo;d also want to experiment with different APIs to find the best source from which to fetch content.</p></li>
<li><p><strong>Add Persistence</strong>: Topicana does not currently remember anything from one request to the next. I&rsquo;d like for users to be able to save past searches and perhaps to look at them side-by-side with current searches. I think this could help users determine the sort of model that works best for their data.</p></li>
<li><p><strong>Improve Appearance/UI</strong>: Topicana does not even have basic CSS yet, and I&rsquo;d at least like to add some basic styling.</p></li>
<li><p><strong>Easy File Import</strong>: Eventually, I&rsquo;d like Topicana to have the ability to directly ingest mixed collections of DOC, TXT, PDF, and other files. I&rsquo;d also like to write a Chrome extension or bookmarklet that users can push to save a page for later processing.</p></li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Topic Modeling My Text Messages]]></title>
    <link href="http://doneallison.github.io/blog/2014/10/20/topic-modeling-my-text-messages/"/>
    <updated>2014-10-20T07:48:26-04:00</updated>
    <id>http://doneallison.github.io/blog/2014/10/20/topic-modeling-my-text-messages</id>
    <content type="html"><![CDATA[<p>Today marks exactly one year since my lovely girlfriend and I began dating. In honor of that occasion (and inspired by posts from <a href="http://blog.kanaabe.com/blog/2014/10/16/the-nokogiri-saw/">Kana Abe</a> and <a href="http://adashofdata.com/2014/10/14/how-text-messages-change-from-dating-to-marriage/">Alice Zhao</a>), I decided to try building a <a href="http://en.wikipedia.org/wiki/Topic_model">topic model</a> of all the text messages we&rsquo;ve sent to each other using <a href="https://www.google.com/settings/takeout">Google Takeout</a>, Ruby, <a href="http://www.nokogiri.org/">Nokogiri</a> (an HTML parser), and <a href="http://mallet.cs.umass.edu/">MALLET</a> (a Java-based command line program for natural language processing). The idea was that I might be able to extract some insight about what we&rsquo;ve been talking about during our relationship and how it has changed over time, much like Professor Robert K. Nelson did for the Civil War in his project <a href="http://dsl.richmond.edu/dispatch/">Mining the Dispatch</a>.<!--more--></p>

<h3>Step One: Download Texts from Google Takeout</h3>

<p>Since I use Google Voice for texting, my first step was to head over to <a href="https://www.google.com/settings/takeout">Google Takeout</a> and download an archive of our texts. Google Takeout is a great feature that allows you to export data from most Google services, including Gmail, Calendar, Contacts, and Hangouts. For this project, however, I was only interested in texts, so I left all boxes unchecked except for Google Voice.</p>

<p>A few minutes later, I received a download link to a ZIP archive of all my Google Voice data. I unpacked the archive and found two files and two folders.</p>

<ul>
<li><strong>Bills.html</strong>: An HTML-format page detailing my Google Voice credit purchase history</li>
<li><strong>Phones.vcf</strong>: A <a href="http://en.wikipedia.org/wiki/VCard">vCard</a>-format archive of my Google Voice contacts</li>
<li><strong>Greetings</strong>: A folder containing an mp3-format copy of my customized voicemail greeting</li>
<li><strong>Calls</strong>: A folder containing HTML-format pages with details about all my calls and texts</li>
</ul>


<p>For the purposes of this project, all I needed was the <strong>Calls</strong> folder. Since the texts themselves were somewhat oddly embedded in 246 HTML files that held as many as 100 texts each, my next step was to parse the HTML files. Enter Nokogiri&hellip;</p>

<h3>Step Two: Extract Text Messages from Archive</h3>

<p><a href="http://www.nokogiri.org/">Nokogiri</a> is a Ruby gem that makes it easy to parse HTML and XML files into usable Ruby objects. In order to use it, I created a new Ruby file called <code>topic-modeling-texts.rb</code> and typed <code>require 'nokogiri'</code> on the first line. This code lets the Ruby interpreter know that it should load the files needed to make Nokogiri run.</p>

<p>Next, I looped through the <strong>Calls</strong> folder and built an array of individual text messages:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="nb">require</span> <span class="s1">&#39;nokogiri&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="n">messages</span> <span class="o">=</span> <span class="o">[]</span>
</span><span class='line'>
</span><span class='line'><span class="no">Dir</span><span class="o">.</span><span class="n">foreach</span><span class="p">(</span><span class="s2">&quot;Voice/Calls/&quot;</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">file</span><span class="o">|</span>
</span><span class='line'>  <span class="k">if</span> <span class="n">file</span><span class="o">.</span><span class="n">include?</span><span class="p">(</span><span class="s2">&quot;Text&quot;</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">file</span><span class="o">.</span><span class="n">include?</span><span class="p">(</span><span class="s2">&quot;5555551234&quot;</span><span class="p">)</span> <span class="o">||</span> <span class="n">file</span><span class="o">.</span><span class="n">include?</span><span class="p">(</span><span class="s2">&quot;Jane Doe&quot;</span><span class="p">))</span>
</span><span class='line'>    <span class="n">current_file</span> <span class="o">=</span> <span class="no">File</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;Voice/Calls/</span><span class="si">#{</span><span class="n">file</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span class='line'>    <span class="n">page_to_parse</span> <span class="o">=</span> <span class="no">Nokogiri</span><span class="o">::</span><span class="no">HTML</span><span class="p">(</span><span class="n">current_file</span><span class="p">)</span>
</span><span class='line'>    <span class="n">current_file</span><span class="o">.</span><span class="n">close</span>
</span><span class='line'>    <span class="n">page_to_parse</span><span class="o">.</span><span class="n">css</span><span class="p">(</span><span class="s2">&quot;div.message q&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">x</span><span class="o">|</span>
</span><span class='line'>      <span class="n">messages</span> <span class="o">&lt;&lt;</span> <span class="n">x</span><span class="o">.</span><span class="n">content</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>In this code, I first create a <code>messages</code> array and set it equal to an empty array.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">messages</span> <span class="o">=</span> <span class="o">[]</span>
</span></code></pre></td></tr></table></div></figure>


<p>Then, I loop through the <code>Voice/Calls/</code> directory and look for files that include the word &ldquo;Text&rdquo; and my girlfriend&rsquo;s name or phone number (name and number changed to protect the innocent!).</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="no">Dir</span><span class="o">.</span><span class="n">foreach</span><span class="p">(</span><span class="s2">&quot;Voice/Calls/&quot;</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">file</span><span class="o">|</span>
</span><span class='line'>  <span class="k">if</span> <span class="n">file</span><span class="o">.</span><span class="n">include?</span><span class="p">(</span><span class="s2">&quot;Text&quot;</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">file</span><span class="o">.</span><span class="n">include?</span><span class="p">(</span><span class="s2">&quot;5555551234&quot;</span><span class="p">)</span> <span class="o">||</span> <span class="n">file</span><span class="o">.</span><span class="n">include?</span><span class="p">(</span><span class="s2">&quot;Jane Doe&quot;</span><span class="p">))</span>
</span></code></pre></td></tr></table></div></figure>


<p>Then, I open each matching file, assign it to a variable called <code>page_to_parse</code>, and tell Nokogiri to treat the object as HTML.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">current_file</span> <span class="o">=</span> <span class="no">File</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;Voice/Calls/</span><span class="si">#{</span><span class="n">file</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span class='line'><span class="n">page_to_parse</span> <span class="o">=</span> <span class="no">Nokogiri</span><span class="o">::</span><span class="no">HTML</span><span class="p">(</span><span class="n">current_file</span><span class="p">)</span>
</span><span class='line'><span class="n">current_file</span><span class="o">.</span><span class="n">close</span>
</span></code></pre></td></tr></table></div></figure>


<p>Finally, the magic happens: Nokogiri&rsquo;s CSS selectors automagically extract all the content between <code>&lt;q&gt;</code> tags in the <code>message</code> class (where the text messages happened to be stored in the HTML pages I downloaded from Google Takeout) and shovel each text message into my <code>messages</code> array.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">page_to_parse</span><span class="o">.</span><span class="n">css</span><span class="p">(</span><span class="s2">&quot;div.message q&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">x</span><span class="o">|</span>
</span><span class='line'>  <span class="n">messages</span> <span class="o">&lt;&lt;</span> <span class="n">x</span><span class="o">.</span><span class="n">content</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>This left me with a nice array of 10,404 text messages. The next challenge was to convert those text messages into a format that MALLET understands.</p>

<h3>Step Three: Preparing the Text Messages for MALLET</h3>

<p>According to <a href="http://mallet.cs.umass.edu/import.php">MALLET&rsquo;s website</a>, users can provide input to the program in two ways:</p>

<ul>
<li>In a single text file, with each line corresponding to a different &ldquo;document&rdquo;</li>
<li>In multiple text files in a single directory, with each file corresponding to a different &ldquo;document&rdquo;</li>
</ul>


<p>Since I was dealing with a large number of &ldquo;documents&rdquo; (text messages), I decided it would be simpler to go with the first option. Back to Ruby!</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="no">File</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;mallet-2.0.7/texts.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;w+&quot;</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">x</span><span class="o">|</span>
</span><span class='line'>  <span class="n">messages</span><span class="o">.</span><span class="n">each_with_index</span> <span class="k">do</span> <span class="o">|</span><span class="n">message</span><span class="p">,</span> <span class="n">index</span><span class="o">|</span>
</span><span class='line'>    <span class="n">x</span><span class="o">.</span><span class="n">puts</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">#{</span><span class="n">index</span><span class="si">}</span><span class="s2"> texts </span><span class="si">#{</span><span class="n">message</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>In this code, I create a new text file called <code>texts.txt</code> in the same directory as the MALLET program files. Then, I iterate through the <code>messages</code> array and write each element to a new line in <code>texts.txt</code>, with an index number and the word &ldquo;texts&rdquo; appended to the front.</p>

<p>For example, a single line in <code>texts.txt</code> might read &ldquo;83 texts How are you today?&rdquo; MALLET requires the &ldquo;83 texts&rdquo; part because it needs an &ldquo;instance name&rdquo; (in this case, 83) and a &ldquo;label&rdquo; (in all these cases, &ldquo;texts&rdquo;) to use in its output files. MALLET construes the remainder of each line as the actual content.</p>

<p>Once I had my <code>texts.txt</code> files prepared, it was time to fire up Terminal and begin interacting with MALLET.</p>

<h3>Step Four: Processing the Text Messages in MALLET</h3>

<p>After <a href="http://mallet.cs.umass.edu/download.php">installing MALLET</a>, my first step in interacting with the program was to navigate to its directory.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">cd</span> <span class="n">mallet</span><span class="o">-</span><span class="mi">2</span><span class="o">.</span><span class="mi">0</span><span class="o">.</span><span class="mi">7</span>
</span></code></pre></td></tr></table></div></figure>


<p>Next, I had to import my <code>texts.txt</code> file and convert it into a form that MALLET can handle. I did this with the <code>import-file</code> command:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">bin</span><span class="o">/</span><span class="n">mallet</span> <span class="n">import</span><span class="o">-</span><span class="n">file</span> <span class="o">--</span><span class="n">input</span> <span class="n">texts</span><span class="o">.</span><span class="n">txt</span> <span class="o">--</span><span class="n">output</span> <span class="n">texts</span><span class="o">.</span><span class="n">mallet</span> <span class="o">--</span><span class="n">keep</span><span class="o">-</span><span class="n">sequence</span> <span class="o">--</span><span class="n">remove</span><span class="o">-</span><span class="n">stopwords</span>
</span></code></pre></td></tr></table></div></figure>


<p>This command has several parameters:</p>

<ul>
<li><code>--input</code> specifies the input file, <code>texts.txt</code></li>
<li><code>--output</code> specifies the output file, <code>texts.mallet</code></li>
<li>According to the MALLET website, <code>--keep-sequence</code> &ldquo;preserves the document as a sequence of word features, rather than a vector of word feature counts.&rdquo; I don&rsquo;t really know what this means, but MALLET yelled at me when I tried to use a file imported without this parameter, so in it went!</li>
<li><code>--remove-stopwords</code> filters the input file and removes common words, like &ldquo;a,&rdquo; &ldquo;an,&rdquo; &ldquo;the,&rdquo; etc. This helps filter noise from the model.</li>
</ul>


<p>After running the command, I ended up with a <code>texts.mallet</code> file, and I was ready to generate some models. I did this with the <code>train-topics</code> command:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">bin</span><span class="o">/</span><span class="n">mallet</span> <span class="n">train</span><span class="o">-</span><span class="n">topics</span> <span class="o">--</span><span class="n">input</span> <span class="n">texts</span><span class="o">.</span><span class="n">mallet</span> <span class="o">--</span><span class="n">num</span><span class="o">-</span><span class="n">topics</span> <span class="mi">25</span> <span class="o">--</span><span class="n">output</span><span class="o">-</span><span class="n">state</span> <span class="n">texts</span><span class="o">-</span><span class="n">state</span><span class="o">.</span><span class="n">gz</span> <span class="o">--</span><span class="n">output</span><span class="o">-</span><span class="n">topic</span><span class="o">-</span><span class="n">keys</span> <span class="n">texts_keys</span><span class="o">.</span><span class="n">txt</span> <span class="o">--</span><span class="n">output</span><span class="o">-</span><span class="n">doc</span><span class="o">-</span><span class="n">topics</span> <span class="n">texts_compostion</span><span class="o">.</span><span class="n">txt</span>
</span></code></pre></td></tr></table></div></figure>


<p>Again, this command includes several parameters:</p>

<ul>
<li><code>--input</code> specifies the input file</li>
<li><code>--num-topics</code> specifies the number of topics MALLET should train. Which number is appropriate depends upon the input material. If the number 5 is used for a highly diverse set of documents, the resulting topics will be overly general and unlikely to correspond to well-defined real-world topics. By contrast, if the number 50 is used for a highly uniform set of documents, then MALLET will search for topics that aren&rsquo;t there and return a lot of &ldquo;false positives&rdquo; (topics that do not correspond to anything in the real world). I went with 25 for the initial run based entirely on gut feeling.</li>
<li><code>--output-state</code> specifies the file in which MALLET should store a compressed text file containing all words in all documents along with their assignments to specific topics</li>
<li><code>--output-topic-keys</code> specifies the file in which MALLET should store a text file that lists the top words for each topic</li>
<li><code>--output-doc-topics</code> specifies the file in which MALLET should store a text file that describes the topic composition of each input document</li>
</ul>


<p>I ran this command several times using different numbers for the <code>num-topics</code> parameter until the keywords looked like they aligned reasonably well with real world topics.</p>

<h3>Step Five: A Brief Analysis</h3>

<p>In the end, 25 topics seemed to provide a decent balance between generality and specificity. In looking at the key words identified in the <code>text-keys.txt</code> file, I can see several topics that could plausibly correspond to real-world concepts. Here are the top words for a few sample topics:</p>

<ul>
<li><strong>Career</strong>: job school project team deloitte offer business high axiom company opportunity booz market afraid entire higher role firm consulting</li>
<li><strong>Plans with Friends</strong>: people weekend travel agree friend making asked plans question forgot taylor made talked discuss questions friends apt date</li>
<li><strong>Everyday Planning and Coordination</strong>: home back dinner call meet leave email place thinking eat leaving hey work food coming late office hour</li>
<li><strong>Travel</strong>: bus interview sunday saturday afternoon dc monday ny prep care st city evening side airport uh final dryer ticket</li>
<li><strong>Budgeting and Investing</strong>: number message basically books account service text texts suit costs gvoice takes silly lot homeless ira transfer set</li>
<li><strong>Sharing Links</strong>: http www html amazon dp utm uber mobile youtube pe ref medium em articles nytimes utf ho strangers apps</li>
</ul>


<p>In order to get these results, I ended up including another parameter called &ldquo;hyperparameter optimization,&rdquo; which allows some topics to be more prominent than others and thus sometimes improves results.</p>

<h3>Conclusions</h3>

<p>Although I had fun reliving the first year of my relationship through a computational lens, I think text messages are ultimately poorly suited to topic modeling. Having used MALLET in the past, I know the software achieves more compelling results with content like newspaper articles. My speculations about why that might be is perhaps a topic for another post!</p>
]]></content>
  </entry>
  
</feed>
